ДОКУМЕНТАЦИЯ К СКРИПТУ ОБРАБОТКИ EXCEL ФАЙЛОВ
===============================================

ОБЩЕЕ ОПИСАНИЕ
--------------
Это скрипт для автоматической обработки Excel файлов. Он читает данные из таблицы,
считает статистику и сохраняет результат.

СТРУКТУРА КОДА
--------------

1. ИМПОРТЫ (строки 1-3)
   - pandas - библиотека для работы с таблицами Excel
   - os - для работы с файлами и папками
   - datetime - для работы с датой и временем (нужно для имени файла)

2. ФУНКЦИЯ обработать_файл (строки 6-52)
   Это основная функция, которая делает всю работу.
   
   Что принимает:
   - путь_к_файлу - путь к Excel файлу который нужно обработать
   - имя_колонки - название колонки для подсчета статистики (по умолчанию 'сумма')
   
   Что делает пошагово:
   
   а) Чтение файла (строки 9-17)
      - Пытается открыть Excel файл через pd.read_excel()
      - Если файл не найден - выводит ошибку и останавливается
      - Если другая ошибка - тоже выводит и останавливается
   
   б) Показ данных (строки 19-20)
      - Выводит первые 5 строк таблицы на экран
      - Это чтобы видеть что файл прочитался правильно
   
   в) Подсчет статистики (строки 23-37)
      - Проверяет есть ли нужная колонка в файле
      - Если есть - считает сумму, среднее, максимум и минимум
      - Если нет - показывает какие колонки есть в файле
   
   г) Сохранение результата (строки 39-50)
      - Создает папку "результаты" если её нет
      - Формирует имя нового файла: старое_имя_обработано_дата_время.xlsx
      - Сохраняет обработанные данные в новый Excel файл
      - Возвращает путь к сохраненному файлу

3. ФУНКЦИЯ создать_пример_файла (строки 55-69)
   Создает тестовый Excel файл для демонстрации работы скрипта.
   
   Что делает:
   - Создает словарь с тестовыми данными (товары, количество, суммы, даты)
   - Преобразует словарь в таблицу pandas (DataFrame)
   - Сохраняет в файл "пример_данных.xlsx"
   - Возвращает имя файла

4. ОСНОВНОЙ КОД (строки 72-84)
   Это то что выполняется когда запускаешь скрипт.
   
   Пошагово:
   - Выводит заголовок
   - Проверяет есть ли файл "пример_данных.xlsx"
   - Если нет - создает его через функцию создать_пример_файла()
   - Вызывает функцию обработать_файл() для обработки
   - Выводит "Готово!"

КАК ЭТО РАБОТАЕТ В ЦЕЛОМ
-------------------------
1. Запускаешь скрипт
2. Скрипт проверяет есть ли пример файла, если нет - создает
3. Открывает Excel файл
4. Показывает что там внутри
5. Считает статистику по указанной колонке
6. Сохраняет результат в папку "результаты"

ЧТО МОЖНО ИЗМЕНИТЬ
------------------
- Путь к файлу: измени "пример_данных.xlsx" на свой файл
- Колонку для статистики: измени 'сумма' на название своей колонки
- Имя папки результатов: измени "результаты" на другое название

ЗАВИСИМОСТИ
-----------
- pandas - для работы с Excel
- openpyxl - для чтения/записи Excel файлов (устанавливается вместе с pandas)
